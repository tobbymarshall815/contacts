{"ast":null,"code":"import _objectSpread from\"/Users/sheygam/contactsapp-web/contacts/JAVA37/REACT/CONTACTS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/sheygam/contactsapp-web/contacts/JAVA37/REACT/CONTACTS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/sheygam/contactsapp-web/contacts/JAVA37/REACT/CONTACTS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/sheygam/contactsapp-web/contacts/JAVA37/REACT/CONTACTS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/sheygam/contactsapp-web/contacts/JAVA37/REACT/CONTACTS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import classes from'../login-component/login.module.css';import{Context}from'../../App';import{withRouter}from'react-router-dom';var BASE_URL='https://contacts-telran.herokuapp.com';var Login=/*#__PURE__*/function(_React$Component){_inherits(Login,_React$Component);var _super=_createSuper(Login);function Login(){var _this;_classCallCheck(this,Login);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={login:'',password:'',isHidden:true};_this.signIn=function(email,password,setErr,setToken,setLoading){var auth={email:email,password:password};var request=JSON.stringify(auth);setLoading();return fetch(\"\".concat(BASE_URL,\"/api/login\"),{method:'POST',headers:{'Content-Type':'application/json; charset=utf-8'},body:request}).then(function(response){if(response.ok){console.log('SIGNIN STATUS:',response.status);response.json().then(function(response){console.log(response.token);localStorage.setItem(\"token\",response.token);_this.props.history.push('./contacts');setToken(response.token);});}else{console.log(response.status);setErr(\"Login Failed with code \".concat(response.status),_this.defineStatusCode(response.status));}}).catch(function(err){setErr(err.message);});};_this.registration=function(email,password,setErr,setToken,setLoading){var auth={email:email,password:password};var requestBody=JSON.stringify(auth);setLoading();return fetch(\"\".concat(BASE_URL,\"/api/registration\"),{method:'POST',headers:{'Content-Type':'application/json; charset=utf-8'},body:requestBody}).then(function(response){if(response.ok){console.log('REGISTRATION STATUS: ',response.status);response.json().then(function(response){console.log(\"REG OK\");localStorage.setItem(\"token\",response.token);_this.props.history.push('./contacts');setToken(response.token);});}else{console.log(response.status);setErr(\"Registration failed with code \".concat(response.status),_this.defineStatusCode(response.status));}}).catch(function(err){setErr(err.message);});};_this.defineStatusCode=function(code){switch(code){case 400:return\"Wrong email or password format\\n            Email must contains one @ and minimum 2 symbols after last dot\\n            Password must contain at least one uppercase letter!\\n            Password must contain at least one lowercase letter!\\n            Password must contain at least one digit!\\n            Password must contain at least one special symbol from [\\u2018$\\u2019,\\u2019~\\u2019,\\u2019-\\u2018,\\u2019_\\u2019]!\";case 409:return\"User already exist\";case 401:return\"Wrong email or password\";default:return\"Undefined Error \".concat(code);}};_this.show=function(){_this.setState(_objectSpread(_objectSpread({},_this.state),{},{isHidden:false}));};return _this;}_createClass(Login,[{key:\"componentDidMount\",value:function componentDidMount(){if(localStorage.getItem('token')){this.props.history.push('/contacts');}}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(Context.Consumer,null,function(obj){return!obj.isLoading?/*#__PURE__*/React.createElement(\"div\",{className:classes.login},obj.error?/*#__PURE__*/React.createElement(\"div\",{style:{color:\"red\",textAlign:\"center\",marginBottom:\"10px\"}},obj.error):null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();var email=e.target.email.value;var password=e.target.password.value;if(e.nativeEvent.submitter.name==='login'){_this2.signIn(email,password,obj.setError,obj.updatetoken,obj.setLoading);}else if(e.nativeEvent.submitter.name==='registration'){_this2.registration(email,password,obj.setError,obj.updatetoken,obj.setLoading);}}},/*#__PURE__*/React.createElement(\"input\",{name:\"email\",placeholder:\"Email\",className:classes.first_input,value:_this2.state.login,onChange:function onChange(e){_this2.setState(_objectSpread(_objectSpread({},_this2.state),{},{login:e.target.value}));}}),/*#__PURE__*/React.createElement(\"input\",{name:\"password\",placeholder:\"Password\",value:_this2.state.password,onChange:function onChange(e){_this2.setState(_objectSpread(_objectSpread({},_this2.state),{},{password:e.target.value}));}}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",name:\"login\"},\"Login\"),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",name:\"registration\"},\"Registration\"))):/*#__PURE__*/React.createElement(\"div\",{className:classes.login},\"LOADING...\");});}}]);return Login;}(React.Component);export default withRouter(Login);","map":{"version":3,"sources":["/Users/sheygam/contactsapp-web/contacts/JAVA37/REACT/CONTACTS/src/components/login-component/login.js"],"names":["React","classes","Context","withRouter","BASE_URL","Login","state","login","password","isHidden","signIn","email","setErr","setToken","setLoading","auth","request","JSON","stringify","fetch","method","headers","body","then","response","ok","console","log","status","json","token","localStorage","setItem","props","history","push","defineStatusCode","catch","err","message","registration","requestBody","code","show","setState","getItem","obj","isLoading","error","color","textAlign","marginBottom","e","preventDefault","target","value","nativeEvent","submitter","name","setError","updatetoken","first_input","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport classes from '../login-component/login.module.css';\nimport {Context} from '../../App';\nimport {withRouter} from 'react-router-dom';\n\nconst BASE_URL = 'https://contacts-telran.herokuapp.com';\n\nclass Login extends React.Component{\n    state = {\n        login:'',\n        password:'',\n        isHidden: true\n    }\n\n    componentDidMount(){\n        if(localStorage.getItem('token')){ \n            this.props.history.push('/contacts');\n        }\n    }\n\n\n    signIn = (email, password, setErr, setToken, setLoading) => {\n        const auth = {email,password};\n        const request = JSON.stringify(auth);\n        setLoading();\n        return fetch(`${BASE_URL}/api/login`, {\n            method:'POST',\n            headers:{'Content-Type':'application/json; charset=utf-8'},\n            body:request\n        }).then(response => {\n            if(response.ok){\n                console.log('SIGNIN STATUS:', response.status);\n                response.json().then((response) => {\n                  console.log(response.token);\n                  localStorage.setItem(\"token\", response.token);\n                  this.props.history.push('./contacts');\n                  setToken(response.token);\n                })\n            }else{\n                console.log(response.status);\n                setErr(`Login Failed with code ${response.status}`, this.defineStatusCode(response.status));\n            }   \n        }).catch(err => {\n            setErr(err.message);\n        });\n    }\n\n    registration = (email, password, setErr, setToken, setLoading) => {\n        const auth = {email,password};\n        const requestBody = JSON.stringify(auth);\n        setLoading();\n        return fetch(`${BASE_URL}/api/registration`,{\n            method:'POST',\n            headers:{\n                'Content-Type':'application/json; charset=utf-8'\n            },\n            body:requestBody\n        }).then(response => {\n            if(response.ok){\n                console.log('REGISTRATION STATUS: ', response.status);\n                response.json().then((response) => {\n                    console.log(\"REG OK\");\n                    localStorage.setItem(\"token\", response.token);\n                    this.props.history.push('./contacts');\n                    setToken(response.token);\n                })   \n            }else{\n                console.log(response.status);\n                setErr(`Registration failed with code ${response.status}`, this.defineStatusCode(response.status));\n            }}).catch(err => {\n                setErr(err.message);\n        });\n    }\n\n    defineStatusCode = (code) => {\n        switch(code){\n            case 400: return `Wrong email or password format\n            Email must contains one @ and minimum 2 symbols after last dot\n            Password must contain at least one uppercase letter!\n            Password must contain at least one lowercase letter!\n            Password must contain at least one digit!\n            Password must contain at least one special symbol from [‘$’,’~’,’-‘,’_’]!`;\n            case 409: return `User already exist`;\n            case 401: return `Wrong email or password`;\n            default: return `Undefined Error ${code}`\n        }\n    }\n\n    show = () => {\n        this.setState({...this.state, isHidden: false});\n    }\n\n    render(){\n        return(\n            <Context.Consumer>\n                {\n                    obj => {\n                        return(\n                            !obj.isLoading ?\n                            <div className={classes.login}>\n                                { obj.error \n                                ? \n                                <div style={{color: \"red\", textAlign:\"center\", marginBottom: \"10px\"}}>\n                                    {obj.error}\n                                </div> \n                                :\n                                 null}\n                                <form onSubmit={e => {\n                                    e.preventDefault();\n                                    let email = e.target.email.value;\n                                    let password = e.target.password.value;\n                                    if(e.nativeEvent.submitter.name === 'login'){\n                                        this.signIn(email, password, obj.setError, obj.updatetoken, obj.setLoading);\n                                    }else if(e.nativeEvent.submitter.name === 'registration'){\n                                        this.registration(email, password, obj.setError, obj.updatetoken, obj.setLoading);\n                                    }\n                                }}>\n                                    <input name=\"email\" placeholder='Email' className={classes.first_input} value={this.state.login} onChange={(e) => {this.setState({...this.state, login:e.target.value})}}/>\n                                    <input name=\"password\" placeholder='Password' value={this.state.password} onChange={(e) => {this.setState({...this.state, password:e.target.value})}}/>\n                                    <br />\n                                    <button type=\"submit\" name=\"login\">Login</button>\n                                    <button type=\"submit\" name=\"registration\">Registration</button>\n                                    {/* <button onClick={() => {this.signIn(this.state.login, this.state.password, obj.setError, obj.updatetoken, obj.setLoading)}}> Login</button>\n                                    <button onClick={() => {this.registration(this.state.login, this.state.password, obj.setError, obj.updatetoken, obj.setLoading)}}> Registration</button> */}\n                                </form>\n                            </div>\n\n                            :\n                            <div className={classes.login}>LOADING...</div>\n                        );\n                    }\n                }\n            </Context.Consumer>\n        );\n    }\n}\n\nexport default withRouter(Login);"]},"metadata":{},"sourceType":"module"}